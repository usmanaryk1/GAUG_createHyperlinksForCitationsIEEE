
<div class="page-body"> 


    <!--PAGE TITLE START -->
    <div class="page-title">
        <div class="title-env">
            <h1 class="title">Daily Attendance</h1>
            <p class="description">Daily Attendance</p>
        </div>
    </div>
    <!--PAGE TITLE END -->

    <div class="row">
        <div class="col-sm-12">
            <div class="panel panel-default">
                <div class="panel-body">

                    <form class="form-horizontal validate" role="form">
                        <div class="row">
                            <div class="col-sm-12 pad0">

                                <div class="col-sm-8 pull-right pad0 wd_full">
                                    <div class="form-group" ng-class="{ 'validate-has-error':dAttendance.searchParams.staffingCordinatorId == null && dAttendance.formSubmitted}">
                                        <label class="col-sm-3 control-label pad_lf0">Employee Name</label>
                                        <div class="col-sm-9"> 
                                            <!--                                            <script type="text/javascript">
                                            //                                                jQuery(document).ready(function($)
                                            //                                                {
                                            //                                                    $("#sboxit-2").selectBoxIt().on('open', function()
                                            //                                                    {
                                            //                                                        // Adding Custom Scrollbar
                                            //                                                        $(this).data('selectBoxSelectBoxIt').list.perfectScrollbar();
                                            //                                                    });
                                            //                                                });
                                                                                        </script>-->
                                            <script type="text/javascript">
                                                jQuery(document).ready(function($)
                                                {
                                                    setTimeout(function() {
                                                        $("#sboxit-2").select2({
//                                                        minimumResultsForSearch: -1,
                                                            placeholder: 'Select Coordinator...',
//                                                        minimumInputLength: 1,
//                                                        placeholder: 'Search',
                                                        }).on('select2-open', function()
                                                        {
                                                            // Adding Custom Scrollbar
                                                            $(this).data('select2').results.addClass('overflow-hidden').perfectScrollbar();
                                                        });
                                                    }, 200);

                                                });
                                            </script>
                                            <select class="form-control" name ="sboxit-2" id="sboxit-2" ng-model="dAttendance.searchParams.staffingCordinatorId" ng-options='emp.id as (emp.label) for emp in dAttendance.employeeList track by emp.id'>
                                                <option value="" selected hidden />
                                            </select>
                                            <div ng-show='dAttendance.searchParams.staffingCordinatorId == null && dAttendance.formSubmitted'>
                                                <span style='color: #cc3f44;display: block;font-size: 12px;padding-top: 5px;'>Please select Employee Name.</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-12 pad0">

                                <div class="form-group col-sm-5 pull-left">
                                    <label class="col-sm-4 control-label pull-left" style="min-width:110px;"><span style="float:left;">Show Entries</span></label>
                                    <div style="width:70px; float:left">
                                        <select class="form-control" ng-model="dAttendance.viewRecords" ng-change="dAttendance.changeViewRecords()">
                                            <option value="10">10</option>
                                            <option value="25">25</option>
                                            <option value="50">50</option>
                                            <option value="100">100</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-sm-7 pull-right wd_full">
                                    <div class="col-sm-6 pad0 wd_full">
                                        <div class="form-group">
                                            <label for="field-68" class="col-sm-3 control-label">From</label>
                                            <div class="col-sm-9">
                                                <div class="input-group">
                                                    <input type="text" id="field-68" class="form-control datepicker" data-format="mm/dd/yyyy" ng-model="dAttendance.searchParams.startDate" max-date="dAttendance.searchParams.endDate" name='fromDate' data-validate="required"  data-message-required="Please select From Date." required>
                                                    <div class="input-group-addon"> <a href="#"><i class="linecons-calendar"></i></a> </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6 ">
                                        <div class="form-group">
                                            <label for="field-69" class="col-sm-3 control-label">To</label>
                                            <div class="col-sm-9 pad_lf0">
                                                <div class="input-group">
                                                    <input type="text" id="field-69" class="form-control datepicker" data-format="mm/dd/yyyy" ng-model="dAttendance.searchParams.endDate" min-date="dAttendance.searchParams.startDate">
                                                    <div class="input-group-addon"> <a href="#"><i class="linecons-calendar"></i></a> </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-12 pad0">
                                <div class="col-sm-6 pull-right">

                                    <button type="submit" class="btn btn-info green_bt pull-right" style="width:auto;" ng-click="dAttendance.filterTimesheet();
                                        dAttendance.formSubmitted = true">Review</button>
                                    <a href="#/app/manual_punch{{dAttendance.searchParams.staffingCordinatorId==null?'':'/employee/'+dAttendance.searchParams.staffingCordinatorId+'?from='+dAttendance.searchParams.startDate+'&to='+dAttendance.searchParams.endDate}}" class="btn btn-info btn-single process_bt pull-right mar_rg5">Manual Punch</a>
                                    <button class="btn btn-info btn-single gray_bt pull-right" type="button" ng-click="dAttendance.resetFilters()">
                                        Reset Filters
                                    </button>
                                </div>
                            </div>
                        </div>

                    </form>
                </div>
                <div class="panel-body pad_top0">
                    <div class="table-responsive border0 scroll search_hide" data-pattern="priority-columns" data-focus-btn-icon="fa-asterisk" data-sticky-table-header="true" data-add-display-all-btn="true" data-add-focus-btn="true">

                        <table id="example-1" class="table table-striped table-bordered  table table-small-font table-bordered table-striped" ng-if="dAttendance.attendanceList.length" datatable-setup cellspacing="0" datatable-obj="dAttendance.datatableObj">
                            <thead>
                                <tr>
                                    <th width="16%" colspan="1" rowspan="1" tabindex="0" nowrap>Date</th>
                                    <th width="17%" colspan="1" rowspan="1" tabindex="0" nowrap>Employee Name</th>
                                    <th width="17%" colspan="1" rowspan="1" tabindex="0" nowrap>Patient Name</th>
                                    <th width="12%" colspan="1" rowspan="1" tabindex="0" nowrap>Time In</th>
                                    <th width="12%" colspan="1" rowspan="1" tabindex="0" nowrap>Time Out</th>
                                    <th class='nosorting' width="10%" data-priority="6" nowrap>Actions</th>
                                    <th class='nosorting' width="16%" data-priority="6" nowrap>Signature</th>
                                </tr>
                            </thead> 
                            <tbody>
                                <tr ng-repeat="timesheet in dAttendance.attendanceList">
                                    <th>
                                        {{timesheet.roundedPunchInTime|timesheetformat}} - {{timesheet.roundedPunchInTime|date :dateFormat}}
                                    </th>
                                    <td>{{timesheet.employeeId.fName + " " + timesheet.employeeId.lName}}</td>
                                    <td>{{timesheet.patientId.fName + " " + timesheet.patientId.lName}}</td>
                                    <td>
                                        <!--Display green dot for matched GPS location-->
                                        <!--<div class="green_dot"></div>-->
                                        <!--Display red dot for not matched GPS location-->
                                        <!--<div class="red_dot"></div>-->
                                        <div ng-class="{'black_dot':timesheet.punchInColorFlag == 'black','red_dot':timesheet.punchInColorFlag == 'red','green_dot':timesheet.punchInColorFlag == 'green'}"></div> 
                                        {{timesheet.roundedPunchInTime|date :timeFormat}}
                                    </td>
                                    <td>
                                        <div ng-class="{'black_dot':timesheet.punchOutColorFlag == 'black','red_dot':timesheet.punchOutColorFlag == 'red','green_dot':timesheet.punchOutColorFlag == 'green'}"></div>
                                        {{timesheet.roundedPunchOutTime|date :timeFormat}}
                                    </td>
                                    <td>
                                        <div style="float:left; min-width:100px;">
                                            <a ng-if="timesheet.isEdited == true" class="btn icon-left fa fa-pencil edit_button" ng-href="#/app/{{timesheet.isMissedPunch===true?'edit_missed_punch':'edit_timesheet'}}/{{timesheet.id}}?cordinatorId={{dAttendance.cordinatorId}}&from={{dAttendance.searchParams.startDate}}&to={{dAttendance.searchParams.endDate}}" tooltip="Edit"><span class="ed_b"></span></a> 
                                            <a ng-if="timesheet.isEdited == true" class="btn icon-left fa fa-trash-o delete_button" href="" ng-click="dAttendance.openDeleteModal(timesheet, 'deleteModel')" tooltip="Delete"><span class="ed_b"></span></a> 
                                            <!--<a class="btn icon-left fa fa-search view_task_button" href="#"><span class="ed_b">Tasks </span></a>-->

                                            <a class=" btn fa fa-search view_task_button" ng-click="dAttendance.openTaskListModal('modal-3', 'lg', 'static', timesheet.tasks);" href="javascript:;" tooltip="View Tasks"><span class="ed_b"></span></a>
                                        </div>
                                    </td>
                                    <td><div ng-if="timesheet.isManualPunch === true">Admin Verified</div>
                                        <img ng-if="(!timesheet.isManualPunch || timesheet.isManualPunch === false) && timesheet.signature && timesheet.signature !== null" width="58" height="34" alt="Signature" ng-src="{{timesheet.signature}}"></td>
                                </tr>
                            </tbody>
                        </table>
                        <div ng-if="(dAttendance.attendanceList == null || dAttendance.attendanceList.length == 0) && dAttendance.dataRetrieved">
                            No daily attendance available for selected coordinator.
                        </div>
                        <div ng-if="dAttendance.criteriaSelected === false">
                            Please select all filters to review daily attendance.
                        </div>
                    </div>
                    <div class="panel-body pad_top0">
                        <div id="example-1_wrapper" class="dataTables_wrapper form-inline dt-bootstrap"><script type="text/javascript">
                            // This JavaScript Will Replace Checkboxes in dropdown toggles
                            jQuery(document).ready(function($)
                            {
                                setTimeout(function()
                                {
                                    $(".checkbox-row input").addClass('cbr');
                                    cbr_replace();
                                }, 0);
                            });
                            </script>

                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>


</div>
<!-- Modal 7 (Ajax Modal)-->
<script type="text/ng-template" id="modal-3">
    <div class="modal-header">
    <h4 class="modal-title">Task List</h4>
    </div>

    <div class="modal-body">
    <div class="row">

    <div class="col-sm-12" ng-repeat="task in taskListModal.taskList" ng-if="taskListModal.taskList!=null && taskListModal.taskList.length>0">
    <div>
    {{task.companyTasksId.task}}
    </div>
    </div>
    <div class="col-sm-12" ng-if="taskListModal.taskList==null || taskListModal.taskList.length==0">
    No tasks are available.

    </div>
    </div>
    </div>

    <div class="modal-footer">
    <button type="button" class="btn btn-white" ng-click="taskListModal.close();">Close</button>
    </div>
</script>
<script type="text/ng-template" id="deleteModel">
    <div class="modal-header">		
    <h4 class="modal-title">{{deletePunchModal.punchObj.punchInTime|timesheetformat}} - {{deletePunchModal.punchObj.punchInTime|date :dateFormat}} - {{deletePunchModal.punchObj.punchInTime|date :timeFormat}} to {{deletePunchModal.punchObj.punchOutTime|date :timeFormat}}</h4>
    </div>

    <div class="modal-body">

    Are you sure you want to delete this Punch record?

    </div>

    <div class="modal-footer">
    <button type="button" class="btn btn-success" ng-click="deletePunchModal.delete(deletePunchModal.punchObj);">Yes</button>
    <button type="button" class="btn btn-red" ng-click="deletePunchModal.dismiss();">No</button>
    </div>
</script>